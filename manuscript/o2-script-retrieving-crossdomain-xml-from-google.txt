## O2 Script - Retrieving crossdomain.xml from Google

This script shows an example of using Google to retrieve the crossdomain.xml file from popular websites Matt Parsons  as also created a [blog post around this script](http://parsonsisconsulting.wordpress.com/2010/12/02/how-to-find-crossdomain-xml-cross-site-request-forgery-with-02/): [sourcecode language="csharp" wraplines="true"] var topPanel = panel.clear().add_Panel(); var ie = topPanel.add_IE().silent(true); ie.open("<a href="http://www.google.com">http://www.google.com</a>"); ie.field("Search").value("inurl:crossdomain.xml filetype:xml");         ie.button("Google Search").click();var listOfUrls = topPanel.insert_Left<Panel>(350).add_TreeView(); var fileContents =listOfUrls.insert_Below<Panel>(200).add_SourceCodeViewer(); listOfUrls.afterSelect<string>(  (selectedUrl)=> {       listOfUrls.backColor(Color.LightPink);       Application.DoEvents();       var html = selectedUrl.uri().getHtml();       fileContents.set_Text(html);       listOfUrls.backColor(Color.White);      }); foreach(var link in ie.links().urls())  if (link.ends("crossdomain.xml"))   listOfUrls.add_Node(link,link); listOfUrls.selectFirst(); return "ok";   //O2File:WatiN_IE_ExtensionMethods.cs //using  O2.XRules.Database.Utils.O2 //O2Ref:WatiN.Core.1x.dll [/sourcecode]
