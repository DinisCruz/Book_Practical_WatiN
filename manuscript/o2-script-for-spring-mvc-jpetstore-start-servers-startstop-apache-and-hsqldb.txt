## O2 Script for "Spring MVC JPetStore - Start Servers" (start/stop apache and hsqldb)

Part of the Spring MVC O2 demos, this script will: 

  * Create a Gui to allow easy start and stop of the JPetStore servers (web and db)
  * Shows how to start an apache server and hsqldb directly (i.e. without using *.bat files)
  * Provide links to the other jPetStore Spring MVC *.h2 scripts

Here is a video of this script in action: [youtube=http://www.youtube.com/watch?v=8Y_zvzLGNtg] This script is included in the jPetStore O2 Demo Pack [which can be downloaded from here](http://s3.amazonaws.com/Demo_Files/jPetStore - O2 Demo Pack.zip) (includes JPetStore and Apache): Here is the script: [sourcecode language="csharp" wraplines="false"] var topPanel = O2Gui.open<Panel>("JPetStore - Start Servers",1000,400); //var topPanel = panel.clear().add_Panel(); Process hsqldbProcess = null; Process apacheProcess = null; var actionPanel = topPanel.insert_Above(20); topPanel.add_LogViewer(); var ie = topPanel.insert_Right().add_IE();</pre> &nbsp; //Processes.getProcessesCalled("java").stop(); var currentFolder = PublicDI.CurrentScript.directoryName(); Action startServers = ()=>{ "Starting Db and Web servers".debug(); // start db server (hsqldb) hsqldbProcess = Processes.startProcessAndRedirectIO("java", @"-classpath .\hsqldb.jar org.hsqldb.Server -database jpetstore", currentFolder.pathCombine("hsqldb"), PublicDI.log.info); //start web server (apache) var tomcatFolder = currentFolder.pathCombine("apache-tomcat-7.0.16"); var apacheBinDirectory =  tomcatFolder.pathCombine("bin"); var apacheStartParameters = ("-Djava.util.logging.config.file=\"{0}\\conf\\logging.properties\" " + "-Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager   " + "-Djava.endorsed.dirs=\"{0}\\endorsed\" " + "-classpath \"{0}\\bin\\bootstrap.jar;{0}\\bin\\tomcat-juli.jar\" " + "-Dcatalina.base=\"{0}\" -Dcatalina.home=\"{0}\" " + "-Djava.io.tmpdir=\"{0}\\temp\" org.apache.catalina.startup.Bootstrap  start" ).format(tomcatFolder) ; apacheProcess = Processes.startProcessAndRedirectIO("java", apacheStartParameters, currentFolder.pathCombine("hsqldb"), PublicDI.log.info); }; Action stopServers = ()=>{ "Stopping Db and Web servers".debug(); apacheProcess.stop(); hsqldbProcess.stop(); }; Action openJPetStore = ()=>{ ie.open("http://localhost:8080/jpetstore"); ie.link("Enter the Store").click(); ie.links().where((link)=> link.url().contains("FISH"))[0].click(); }; actionPanel.add_Link("Start Servers",0,0,()=>startServers()) .append_Link("Stop Servers",()=>stopServers()) .append_Link("Enter JPetStore and open a Page", ()=> openJPetStore()) .append_Link("JpetStore - BlackBox Exploits.h2" ,()=> "JpetStore - BlackBox Exploits.h2".local().executeH2Script() ) .append_Link("JPetStore - View Controllers.h2"  ,()=> currentFolder.pathCombine("JPetStore - View Controllers.h2").executeH2Script() );   ; return "ok"; //using System.Diagnostics //O2File:WatiN_IE_ExtensionMethods.cs //using O2.XRules.Database.Utils.O2 //O2Ref:WatiN.Core.1x.dll [/sourcecode]
