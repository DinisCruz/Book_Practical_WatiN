## Writing an O2 'IE Automation' Script for JPetStore Account Creation

Here is a video and script of the interactive process of writing an O2 IE Automation Script for JPetStore. [youtube=http://www.youtube.com/watch?v=J4Ojqzb6qsw] This is is the original script as shown in the video: [sourcecode language="csharp" wraplines="false"] panel.clear(); var ie = panel.add_IE().silent(true);</pre> &nbsp; //ie.open("http://localhost:8080/jpetstore"); //ie.link("Enter the Store").click(); ie.open("http://localhost:8080/jpetstore/shop/newAccount.do"); ie.field("account.username").value("a user"); ie.field("account.password").value("pwd"); ie.field("repeatedPassword").value("pwd"); ie.field("account.firstName").value("first"); ie.field("account.lastName").value("name"); ie.field("account.address1").value("1"); ie.field("account.phone").value("2"); ie.field("account.city").value("3"); ie.field("account.state").value("4"); ie.field("account.zip").value("5"); ie.field("account.country").value("6"); ie.field("account.email").value("7"); ie.button("Save Account Information").click(); //return ie.buttons(); //ie.inject_FirebugLite(); //return ie.links(); //O2File:WatiN_IE_ExtensionMethods.cs //using O2.XRules.Database.Utils.O2 //O2Ref:WatiN.Core.1x.dll [/sourcecode] Which was then added to the API_JPetStore.cs as a couple createAccount(...) extension methods: [sourcecode language="csharp" wraplines="false"] public static API_JPetStore createAccount(this API_JPetStore jPetStore, string username, string password) { return jPetStore.createAccount(username, password, username,10.randomLetters(),10.randomLetters(), 10.randomLetters(),10.randomLetters(),10.randomLetters(), 10.randomLetters(),10.randomLetters(),10.randomLetters()); } public static API_JPetStore createAccount(this API_JPetStore jPetStore, string username, string password , string firstName, string lastName, string address1, string phone, string city, string state, string zip, string country, string email) { jPetStore.open("/shop/newAccount.do"); var ie = jPetStore.ie; ie.field("account.username").value(username); ie.field("account.password").value(password); ie.field("repeatedPassword").value(password); ie.field("account.firstName").value(firstName); ie.field("account.lastName").value(lastName); ie.field("account.address1").value(address1); ie.field("account.phone").value(phone); ie.field("account.city").value(city); ie.field("account.state").value(state); ie.field("account.zip").value(zip); ie.field("account.country").value(country); ie.field("account.email").value(email); ie.button("Save Account Information").click(); return jPetStore; } [/sourcecode] So that they can be easily consumed like this: [sourcecode language="csharp" wraplines="false"] panel.clear(); var ie = panel.add_IE().silent(true);</pre> &nbsp; var jPetStore = new API_JPetStore(ie); jPetStore.createAccount("user12","pwd"); //create user jPetStore.logout();                         // logout jPetStore.login("user12","pwd____");      //should fail (wrong password) jPetStore.login("user12","pwd");          //should work //O2File:API_JPetStore.cs //O2File:WatiN_IE_ExtensionMethods.cs //using O2.XRules.Database.Utils.O2 //O2Ref:WatiN.Core.1x.dll [/sourcecode] Here is a screenshot of the user created with the script above (note the random values) ![](images/tmp7d2e-tmp.jpeg)
